
-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `email_templates`
--
-- Creación: 30-12-2025 a las 19:23:12
-- Última actualización: 30-12-2025 a las 19:23:12
--

DROP TABLE IF EXISTS `email_templates`;
CREATE TABLE IF NOT EXISTS `email_templates` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL COMMENT 'Nombre interno de la plantilla (ej: email-verification)',
  `display_name` varchar(255) NOT NULL COMMENT 'Nombre para mostrar en el admin',
  `subject` varchar(255) NOT NULL COMMENT 'Asunto del correo (puede contener variables {{variable}})',
  `body_html` longtext NOT NULL COMMENT 'Cuerpo HTML del correo con variables',
  `body_text` text DEFAULT NULL COMMENT 'Versión texto plano (opcional)',
  `variables` text DEFAULT NULL COMMENT 'JSON con descripción de variables disponibles',
  `is_active` tinyint(1) DEFAULT 1 COMMENT 'Si la plantilla está activa',
  `category` varchar(50) DEFAULT 'general' COMMENT 'Categoría: auth, order, notification, etc.',
  `description` text DEFAULT NULL COMMENT 'Descripción de cuándo se usa esta plantilla',
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id`),
  UNIQUE KEY `unique_name` (`name`),
  KEY `idx_category` (`category`),
  KEY `idx_active` (`is_active`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- RELACIONES PARA LA TABLA `email_templates`:
--

--
-- Truncar tablas antes de insertar `email_templates`
--

TRUNCATE TABLE `email_templates`;
--
-- Volcado de datos para la tabla `email_templates`
--

INSERT IGNORE INTO `email_templates` (`id`, `name`, `display_name`, `subject`, `body_html`, `body_text`, `variables`, `is_active`, `category`, `description`, `created_at`, `updated_at`) VALUES
(1, 'email-verification', 'Verificación de Correo', 'Verifica tu correo electrónico - {{company_name}}', '<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>{{subject}}</title>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, \'Helvetica Neue\', Arial, sans-serif; background-color: #f3f4f6;\">\r\n  {{email_header}}\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f4f6; padding: 40px 20px;\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\r\n          <tr>\r\n            <td style=\"padding: 40px;\">\r\n              <p style=\"color: #1f2937; font-size: 18px; line-height: 1.6; margin: 0 0 20px 0;\">\r\n                Hola <strong>{{userName}}</strong>,\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                Gracias por registrarte en {{company_name}}. Para completar tu registro y acceder a todas las funciones, por favor verifica tu dirección de correo electrónico haciendo clic en el botón de abajo.\r\n              </p>\r\n              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n                <tr>\r\n                  <td align=\"center\" style=\"padding: 20px 0;\">\r\n                    <a href=\"{{verificationLink}}\" style=\"display: inline-block; background: linear-gradient(135deg, {{primary_color}} 0%, {{secondary_color}} 100%); color: #ffffff; text-decoration: none; padding: 14px 32px; border-radius: 6px; font-weight: bold; font-size: 16px;\">Verificar Mi Correo</a>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n              <p style=\"color: #9ca3af; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; text-align: center;\">\r\n                O copia y pega este enlace en tu navegador:<br>\r\n                <a href=\"{{verificationLink}}\" style=\"color: {{primary_color}}; word-break: break-all;\">{{verificationLink}}</a>\r\n              </p>\r\n              <p style=\"color: #6b7280; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; padding-top: 20px; border-top: 1px solid #e5e7eb;\">\r\n                <strong>Importante:</strong> Este enlace expirará en {{expiresIn}}. Si no verificas tu correo antes de esa fecha, deberás solicitar un nuevo enlace de verificación.\r\n              </p>\r\n              <p style=\"color: #9ca3af; font-size: 14px; line-height: 1.6; margin: 20px 0 0 0;\">\r\n                Si no creaste una cuenta en {{company_name}}, puedes ignorar este correo de forma segura.\r\n              </p>\r\n            </td>\r\n          </tr>\r\n          {{email_footer}}\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</body>\r\n</html>', NULL, '{\"userName\": \"Nombre del usuario\", \"verificationLink\": \"URL de verificación\", \"expiresIn\": \"Tiempo de expiración\", \"company_name\": \"Nombre de la empresa\"}', 1, 'auth', 'Se envía cuando un usuario se registra y necesita verificar su correo', '2025-12-30 19:23:12', '2025-12-30 19:23:12'),
(2, 'password-reset', 'Recuperación de Contraseña', 'Recuperación de contraseña - {{company_name}}', '<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>{{subject}}</title>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, \'Helvetica Neue\', Arial, sans-serif; background-color: #f3f4f6;\">\r\n  {{email_header}}\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f4f6; padding: 40px 20px;\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\r\n          <tr>\r\n            <td style=\"padding: 40px;\">\r\n              <p style=\"color: #1f2937; font-size: 18px; line-height: 1.6; margin: 0 0 20px 0;\">\r\n                Hola <strong>{{userName}}</strong>,\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                Recibimos una solicitud para restablecer la contraseña de tu cuenta en {{company_name}}. Si fuiste tú, haz clic en el botón de abajo para crear una nueva contraseña.\r\n              </p>\r\n              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n                <tr>\r\n                  <td align=\"center\" style=\"padding: 20px 0;\">\r\n                    <a href=\"{{resetLink}}\" style=\"display: inline-block; background: linear-gradient(135deg, {{primary_color}} 0%, {{secondary_color}} 100%); color: #ffffff; text-decoration: none; padding: 14px 32px; border-radius: 6px; font-weight: bold; font-size: 16px;\">Restablecer Contraseña</a>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n              <p style=\"color: #9ca3af; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; text-align: center;\">\r\n                O copia y pega este enlace en tu navegador:<br>\r\n                <a href=\"{{resetLink}}\" style=\"color: {{primary_color}}; word-break: break-all;\">{{resetLink}}</a>\r\n              </p>\r\n              <p style=\"color: #6b7280; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; padding-top: 20px; border-top: 1px solid #e5e7eb;\">\r\n                <strong>Importante:</strong> Este enlace expirará en {{expiresIn}}. Si no solicitaste restablecer tu contraseña, puedes ignorar este correo de forma segura.\r\n              </p>\r\n            </td>\r\n          </tr>\r\n          {{email_footer}}\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</body>\r\n</html>', NULL, '{\"userName\": \"Nombre del usuario\", \"resetLink\": \"URL para restablecer contraseña\", \"expiresIn\": \"Tiempo de expiración\", \"company_name\": \"Nombre de la empresa\"}', 1, 'auth', 'Se envía cuando un usuario solicita recuperar su contraseña', '2025-12-30 19:23:12', '2025-12-30 19:23:12'),
(3, 'password-changed', 'Contraseña Cambiada', 'Tu contraseña ha sido cambiada - {{company_name}}', '<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>{{subject}}</title>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, \'Helvetica Neue\', Arial, sans-serif; background-color: #f3f4f6;\">\r\n  {{email_header}}\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f4f6; padding: 40px 20px;\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\r\n          <tr>\r\n            <td style=\"padding: 40px;\">\r\n              <p style=\"color: #1f2937; font-size: 18px; line-height: 1.6; margin: 0 0 20px 0;\">\r\n                Hola <strong>{{userName}}</strong>,\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                Te informamos que la contraseña de tu cuenta en {{company_name}} ha sido cambiada exitosamente.\r\n              </p>\r\n              <p style=\"color: #6b7280; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; padding-top: 20px; border-top: 1px solid #e5e7eb;\">\r\n                <strong>Fecha del cambio:</strong> {{changedAt}}<br>\r\n                <strong>IP:</strong> {{ipAddress}}\r\n              </p>\r\n              <p style=\"color: #dc2626; font-size: 14px; line-height: 1.6; margin: 20px 0 0 0; padding: 15px; background-color: #fef2f2; border-radius: 6px; border-left: 4px solid #dc2626;\">\r\n                <strong>⚠️ ¿No reconoces este cambio?</strong><br>\r\n                Si no realizaste este cambio, por favor contacta a nuestro equipo de soporte inmediatamente.\r\n              </p>\r\n            </td>\r\n          </tr>\r\n          {{email_footer}}\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</body>\r\n</html>', NULL, '{\"userName\": \"Nombre del usuario\", \"changedAt\": \"Fecha del cambio\", \"ipAddress\": \"IP desde donde se hizo el cambio\", \"company_name\": \"Nombre de la empresa\"}', 1, 'auth', 'Se envía cuando un usuario cambia su contraseña exitosamente', '2025-12-30 19:23:12', '2025-12-30 19:23:12'),
(4, 'welcome', 'Bienvenida', '¡Bienvenido a {{company_name}}!', '<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>{{subject}}</title>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, \'Helvetica Neue\', Arial, sans-serif; background-color: #f3f4f6;\">\r\n  {{email_header}}\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f4f6; padding: 40px 20px;\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\r\n          <tr>\r\n            <td style=\"padding: 40px;\">\r\n              <p style=\"color: #1f2937; font-size: 18px; line-height: 1.6; margin: 0 0 20px 0;\">\r\n                ¡Hola <strong>{{userName}}</strong>!\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                ¡Bienvenido a {{company_name}}! Estamos emocionados de tenerte como parte de nuestra comunidad.\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                Ahora puedes explorar nuestra amplia selección de productos y disfrutar de una experiencia de compra única.\r\n              </p>\r\n              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n                <tr>\r\n                  <td align=\"center\" style=\"padding: 20px 0;\">\r\n                    <a href=\"{{shopLink}}\" style=\"display: inline-block; background: linear-gradient(135deg, {{primary_color}} 0%, {{secondary_color}} 100%); color: #ffffff; text-decoration: none; padding: 14px 32px; border-radius: 6px; font-weight: bold; font-size: 16px;\">Explorar Tienda</a>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </td>\r\n          </tr>\r\n          {{email_footer}}\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</body>\r\n</html>', NULL, '{\"userName\": \"Nombre del usuario\", \"shopLink\": \"URL de la tienda\", \"company_name\": \"Nombre de la empresa\"}', 1, 'notification', 'Se envía cuando un usuario completa su registro y verifica su correo', '2025-12-30 19:23:12', '2025-12-30 19:23:12'),
(5, 'security-notification', 'Notificación de Seguridad', 'Actividad de seguridad en tu cuenta - {{company_name}}', '<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>{{subject}}</title>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, \'Helvetica Neue\', Arial, sans-serif; background-color: #f3f4f6;\">\r\n  {{email_header}}\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f4f6; padding: 40px 20px;\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\r\n          <tr>\r\n            <td style=\"padding: 40px;\">\r\n              <p style=\"color: #1f2937; font-size: 18px; line-height: 1.6; margin: 0 0 20px 0;\">\r\n                Hola <strong>{{userName}}</strong>,\r\n              </p>\r\n              <p style=\"color: #4b5563; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;\">\r\n                {{securityMessage}}\r\n              </p>\r\n              <p style=\"color: #6b7280; font-size: 14px; line-height: 1.6; margin: 30px 0 0 0; padding-top: 20px; border-top: 1px solid #e5e7eb;\">\r\n                <strong>Detalles:</strong><br>\r\n                Fecha: {{eventDate}}<br>\r\n                IP: {{ipAddress}}<br>\r\n                {{#if device}}Dispositivo: {{device}}{{/if}}\r\n              </p>\r\n              {{#if actionRequired}}\r\n              <p style=\"color: #dc2626; font-size: 14px; line-height: 1.6; margin: 20px 0 0 0; padding: 15px; background-color: #fef2f2; border-radius: 6px; border-left: 4px solid #dc2626;\">\r\n                <strong>⚠️ Acción requerida:</strong><br>\r\n                Si no reconoces esta actividad, por favor contacta a nuestro equipo de soporte inmediatamente.\r\n              </p>\r\n              {{/if}}\r\n            </td>\r\n          </tr>\r\n          {{email_footer}}\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</body>\r\n</html>', NULL, '{\"userName\": \"Nombre del usuario\", \"securityMessage\": \"Mensaje de seguridad\", \"eventDate\": \"Fecha del evento\", \"ipAddress\": \"IP\", \"device\": \"Dispositivo (opcional)\", \"actionRequired\": \"Si se requiere acción\"}', 1, 'notification', 'Se envía para notificaciones de seguridad (2FA, cambio de email, etc.)', '2025-12-30 19:23:12', '2025-12-30 19:23:12');
